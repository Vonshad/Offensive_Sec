# Enumeration Cheat Sheet
> The goal of this cheat sheet is to act as a reminder of basic enumeration steps for most common ports. Ports will be displayed in order from smallest number to biggest number.

## Port 21 - FTP
> FTP can be a useful port when combined with an HTTP server. If anonymous access is enabled, make sure to check the structure of the FTP filesystem and compare it with the HTTP server. If they are the same, look for upload permissions within the FTP server. When found, upload a revshell that would work on the web server.

#### Connect to the FTP server
> For credentials, try `anonymous` without a password. Otherwise, you will need credentials to connect.

`ftp $victim_ip`

#### Upload / Download
> Make sure that you are in binary mode when doing this. To do so, type `binary` once you are connected.

`put $filename` --> File Upload

`get $filename` --> File Download


## Port 22 - SSH
> SSH usually isn't a way in on its own. However, if you come across credentials, find a private key, or manage to inject your own public key in the victim's `authorized_keys` file, SSH can be used.

#### Connecting to SSH
> This will connect to the default port of 22. If the SSH port is different, add a `-p $victim_port` flag.

`ssh USER@IP` --> Connect via user/password

`ssh USER@IP -i <PRIVATEKEYFILE>` --> Connect via private SSH key.

#### Bruteforcing SSH
> If you come across a password wordlist during your CTF and you already have a username, it may be worth trying to bruteforce the SSH creds.

`hydra -l <USERNAME> -P <PASSWORD_FILE> $victim_ip ssh` --> Brute force using a single username and a password file. Alternatively, you can use `-L USERNAME_FILE` instead of a single username if you want to try multiple usernames.

## Port 80 - HTTP
> Take note that HTTP servers are popularly hosted on various ports. Furthermore, these steps also work with HTTPS ports. However, in the case of a custom-signed certificate, you may need to add a flag that ignores certificate checks to your commands.

#### Directory Fuzzing
> My go-to directory busting tool is `gobuster` with the Kali pre-installed wordlist `directory-list-2.3-medium.txt`.

`gobuster dir -w <WORDLIST> -u http://$victim_ip/`

`dirb http://$victim_ip/` --> Alternative CLI tool.

#### File Fuzzing
> This step depends on the backend of the webserver. For example, if the webserver is running Apache, you will want to look for `.php` files. As a rule of thumb, I always look for the appropriate file extension, for `.txt` files and for `.html` files.

`gobuster dir -w <WORDLIST> -x <extensions,you,want,to,look,for> -u http://$victim_ip/`

`gobuster dir -w <WORDLIST> -x .php,.txt,.html -u http://10.10.10.10:80/` --> Usage example

#### Subdomains Fuzzing
> Always look for subdomains. In order to do so efficiently, make sure the victim's IP is associated to an alias in the `/etc/hosts` files. Let's pretend we have the `victim.ip` alias for our victim's IP. My default wordlist is the kali pre-installed `subdomains-top1mil-20000.txt` wordlist.

> Subdomains busting is a two-step process. First, we want to start the scan without any filters. Then, once we get the amount of words that is being returned when querying a nonexistent subdomain, we will filter them out.

> Lastly, once you've found a working subdomain, make sure to add it to the /etc/hosts file. For example, we could have `subdomain.victim.ip` added do the file in order to access it.

##### Step 1. This will return a lot of errors with a `400 Response`. Grab the number shown in the `Word` column of the output
`wfuzz -c -f sub-fighter -w <WORDLIST> -u "http://victim.ip" -H "Host: FUZZ.victim.ip"`

##### Step 2. Filter the output
`wfuzz -c -f sub-fighter -w <WORDLIST> -u "http://victim.ip" -H "Host: FUZZ.victim.ip" --hw <WORDCOUNT TO FILTER OUT>`

## Port 139/445 - SMB

#### Checking for a vulnerable SMB version
> Since SMB is quite popular in CTFs for the famous EternalBlue exploit (amongst others), it is worth scanning it for vulnerabilities. Nmap has well-designed scripts for this purpose.

`nmap -p139,445 --script=smb-vuln* $victim_ip` --> This will run every nmap scripts for `smb-vuln`. You can pick and choose which ones you want to run by going to the nmap NSE scripts folder in Kali.

#### Listing SMB shares
> Often encountered optional flags are `-U <username>` and `-P` if you have credentials.

`smbclient -L \\\\$victim_ip\\` --> Since `\` is an escape character in our shell, we need to escape it (intuitive, isn't it?) before we can use it in our command, hence why we have 4 and 2 of them respectively. In reality, the "escaped" output of this is `\\$victim_ip\`.

#### Connecting to a SMB share
> Often encountered optional flags are `-U <username>` and `-P` if you have credentials.

`smbclient //$victim_ip/<SHARE_NAME>`

#### Uploading / Downloading files
> Similar to FTP, we can upload and download files to SMB. However, SMB transfers are always in binary and we do not need to specify this option.

`put <local_file_name> [remote_file_name]` --> Upload a remote file

`get <remote_file_name> [local_file_name]` --> Download a remote file

## Port 3389 - RDP
> Windows' Remote Desktop Protocol is similar to SSH: it usually is not a way in on its own. However, if you have credentials, it is a great idea to try them out here.

#### Connecting to RDP
> I prefer using a GUI program such as `Remmina` in order to access RDP. However, I will display CLI options here.

`xfreerdp -g 1920x1080 -u USERNAME $victim_ip` --> `-g` is the resolution and can be changed to your needs.

#### Bruteforcing RDP
> If you find a username (or a username list) and a password list, you can try bruteforcing RDP.

`hydra -l <USERNAME> -P <PASSWORD_FILE> rdp://$victim_ip` --> Brute force using a single username and a password file. Alternatively, you can use `-L USERNAME_FILE` instead of a single username if you want to try multiple usernames.


### I will add more to this cheatsheet as I go. Thanks for reading!
